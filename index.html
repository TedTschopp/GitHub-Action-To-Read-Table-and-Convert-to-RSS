---
layout: default
class: home-template
---

<!-- Start Featured Posts -->
<div class="featured-posts">
    <div class="section-title">
        <h2><span>RSS Feeds</span></h2>
    </div>
        <div class="row">
        {% for feed in site.rss_feeds %}
            <div class="col-md-12">
                <div class="card border-0 mb-4 box-shadow">
                    <div class="card-header d-flex justify-content-between align-items-start flex-wrap">
                        <div>
                            <h2 class="card-title mb-1"><a href="{{ feed.url }}">{{ feed.name }}</a></h2>
                            <small class="text-muted">{{ feed.description }}</small>
                        </div>
                        <div>
                            <a href="{{ feed.url }}" class="btn btn-sm btn-outline-success"><i class="fas fa-rss"></i> RSS</a>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="feed-preview-{{ forloop.index0 }}" class="rss-preview" data-feed-index="{{ forloop.index0 }}">Loading latest entries...</div>
                    </div>
                </div>
            </div>
        {% endfor %}
        </div>
</div>

<!-- RSS Status -->
<div class="rss-status mt-5" style="display: none;">
    <div class="section-title">
        <h2><span>Feed Status</span></h2>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="card border-0 box-shadow">
                <div class="card-body">
                    <div id="rss-status-content">
                        Loading feed status...
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript for RSS preview -->
<script>
(function(){
    if(document.readyState==='loading'){
        document.addEventListener('DOMContentLoaded', arguments.callee, {once:true});
        return;
    }
    const feeds = {{ site.rss_feeds | jsonify }};
    const limit = {{ site.rss_preview_limit | default: 5 }};
    function esc(s){return (s||'').replace(/[&<>"']/g,c=>({"&":"&amp;","<":"&lt;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c]||c));}
    function parseItems(xml){
        const doc = new DOMParser().parseFromString(xml,'application/xml');
        if(doc.querySelector('parsererror')) return [];
        return Array.from(doc.querySelectorAll('item')).slice(0,limit).map(it=>{
            const t = esc(it.querySelector('title')?.textContent||'Untitled');
            const l = esc(it.querySelector('link')?.textContent||'#');
            const dRaw = it.querySelector('pubDate')?.textContent; let d='';
            if(dRaw){ const dt=new Date(dRaw); if(!isNaN(dt)) d = dt.toISOString().slice(0,10); }
            return `<li><a href="${l}" rel="noopener noreferrer">${t}</a>${d?` <span class="pubdate">(${d})</span>`:''}</li>`;
        });
    }
    feeds.forEach((f,i)=>{
        const el = document.getElementById('feed-preview-'+i);
        if(!el) return;
        fetch(f.url).then(r=>{ if(!r.ok) throw new Error('HTTP '+r.status); return r.text(); })
            .then(txt=>{
                const items = parseItems(txt);
                el.innerHTML = items.length ? `<ul class="rss-items">${items.join('')}</ul>` : '<div class="text-muted"><small>No recent items.</small></div>';
            })
            .catch(err=>{ el.innerHTML = '<div class="rss-error"><small>Preview error: '+esc(err.message)+'</small></div>'; });
    });
})();
</script>
                function getItemDate(item, isAtom) {
                    if (isAtom) {
                        // Atom feeds use <updated> or <published>
                        return item.querySelector('updated')?.textContent || 
                               item.querySelector('published')?.textContent || '';
                    } else {
                        // RSS feeds use <pubDate>
                        return item.querySelector('pubDate')?.textContent || '';
                    }
                }
                
                // Helper function to get title from either RSS or Atom entry
                function getItemTitle(item) {
                    return item.querySelector('title')?.textContent || 'No title';
                }
                
                // Helper function to get link from either RSS or Atom entry
                function getItemLink(item, isAtom) {
                    if (isAtom) {
                        // Atom feeds use <link href="...">
                        const linkElement = item.querySelector('link[href]');
                        return linkElement?.getAttribute('href') || '#';
                    } else {
                        // RSS feeds use <link>text</link>
                        return item.querySelector('link')?.textContent || '#';
                    }
                }
                
                // Helper function to get description from either RSS or Atom entry
                function getItemDescription(item, isAtom) {
                    if (isAtom) {
                        // Atom feeds use <summary> or <content>
                        const summary = item.querySelector('summary')?.textContent || '';
                        const content = item.querySelector('content')?.textContent || '';
                        return summary || content;
                    } else {
                } else if (error.message.includes('Failed to fetch')) {
                    errorType = 'Network Error';
                    suggestion = 'Check if the feed URL is accessible and the server is responding.';
                } else if (error.message.includes('Redirect was not allowed')) {
                    errorType = 'Redirect Error';
                    suggestion = 'The URL redirects to an insecure location. Try using the direct HTTPS URL.';
                }
                
                console.error('Error Classification:', errorType);
                console.error('Suggestion:', suggestion);
                console.error('=============================');
                
                previewElement.innerHTML = `
                    <div class="alert alert-warning">
                        <strong>Unable to load feed preview</strong><br>
                        <small class="text-muted">
                            <strong>Feed:</strong> ${feed.name}<br>
                            <strong>URL:</strong> <code>${feed.url}</code><br>
                            <strong>Error Type:</strong> ${errorType}<br>
                            <strong>Details:</strong> ${error.message || 'Unknown error'}<br>
                            ${suggestion ? `<strong>Suggestion:</strong> ${suggestion}<br>` : ''}
                            <em>Check browser console for technical details.</em>
                        </small>
                    </div>
                `;
            });
    }); // end rssFeeds.forEach
})();
</script>
